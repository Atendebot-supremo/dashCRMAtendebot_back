â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           ğŸ“š GUIA COMPLETO DE ROTAS CRM - FRONTEND
           (ApÃ³s fazer login e receber o token)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”‘ AUTENTICAÃ‡ÃƒO OBRIGATÃ“RIA
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TODAS as rotas CRM requerem o token JWT no header:

Header obrigatÃ³rio em TODAS as requisiÃ§Ãµes:
  Authorization: Bearer ${token}

Onde ${token} Ã© o token recebido na resposta do login:
  data.token

âš ï¸ IMPORTANTE:
  â€¢ Sem o token, vocÃª receberÃ¡ erro 401 (Unauthorized)
  â€¢ Token expira em 8 horas
  â€¢ Se receber 401, faÃ§a logout e login novamente
  â€¢ Rate Limit: 60 requisiÃ§Ãµes por minuto


ğŸ“‹ ROTAS DISPONÃVEIS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. GET  /api/crm/panels           - Lista todos os painÃ©is
2. GET  /api/crm/panels/:id       - Detalhes de um painel
3. GET  /api/crm/cards            - Lista cards (requer panelId)
4. GET  /api/crm/cards/:id        - Detalhes de um card
5. GET  /api/crm/agents           - Lista agentes (requer panelId)
6. GET  /api/crm/agents/:id       - Detalhes de um agente


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             ROTA 1: LISTAR PAINÃ‰IS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/panels

DescriÃ§Ã£o: Lista todos os painÃ©is CRM do usuÃ¡rio autenticado.

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Query Parameters: Nenhum
ğŸ“¦ Headers: Authorization: Bearer ${token}

Detalhes incluÃ­dos automaticamente (Helena IncludeDetails):
  â€¢ Tags
  â€¢ Steps
  â€¢ StepsCardCount
  â€¢ PanelCardOverdueCount

Exemplo de RequisiÃ§Ã£o:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const token = localStorage.getItem('auth_token')

const response = await fetch('http://localhost:3000/api/crm/panels', {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "items": [
      {
        "id": "fa8c96c0-db47-42f4-9f83-d1e257ab4a11",
        "name": "Nome do Painel",
        "description": "DescriÃ§Ã£o do painel",
        "createdAt": "2025-12-03T16:27:34.767015Z",
        "updatedAt": "2025-12-03T17:03:50.343603Z",
        "steps": [
          {
            "id": "4645a498-48b7-4d27-84dd-74d90fed09f6",
            "title": "Nome do Step",
            "phase": "phase-name",
            "position": 1
          }
        ]
      }
    ],
    "totalItems": 1
  },
  "message": "PainÃ©is listados com sucesso"
}

Response 401 (NÃ£o autorizado):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": false,
  "error": "Token nÃ£o informado",
  "code": "UNAUTHORIZED"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          ROTA 2: DETALHES DE UM PAINEL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/panels/:id

DescriÃ§Ã£o: ObtÃ©m detalhes completos de um painel especÃ­fico.

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Path Parameters:
   â€¢ id (string, obrigatÃ³rio) - ID do painel

Exemplo de RequisiÃ§Ã£o:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const panelId = 'fa8c96c0-db47-42f4-9f83-d1e257ab4a11'
const token = localStorage.getItem('auth_token')

const response = await fetch(`http://localhost:3000/api/crm/panels/${panelId}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "id": "fa8c96c0-db47-42f4-9f83-d1e257ab4a11",
    "name": "Nome do Painel",
    "description": "DescriÃ§Ã£o do painel",
    "createdAt": "2025-12-03T16:27:34.767015Z",
    "updatedAt": "2025-12-03T17:03:50.343603Z",
    "steps": [...]
  },
  "message": "Painel encontrado com sucesso"
}

Response 404 (NÃ£o encontrado):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": false,
  "error": "Painel nÃ£o encontrado",
  "code": "NOT_FOUND"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              ROTA 3: LISTAR CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/cards

DescriÃ§Ã£o: Lista cards com filtros opcionais (paginaÃ§Ã£o, datas, usuÃ¡rios, etc).

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Query Parameters:
   â€¢ panelId (string, OBRIGATÃ“RIO) - ID do painel
   â€¢ startDate (string, opcional) - Data inicial ISO 8601: "2025-12-01T00:00:00Z"
   â€¢ endDate (string, opcional) - Data final ISO 8601: "2025-12-31T23:59:59Z"
   â€¢ userId (string, opcional) - Filtrar por ID do usuÃ¡rio responsÃ¡vel
   â€¢ channelId (string, opcional) - Filtrar por canal
   â€¢ stepId (string, opcional) - Filtrar por step do painel
   â€¢ page (number, opcional) - NÃºmero da pÃ¡gina (padrÃ£o: 1)
   â€¢ pageSize (number, opcional) - Itens por pÃ¡gina (padrÃ£o: 100, mÃ¡ximo: 1000)

Detalhes incluÃ­dos automaticamente (Helena IncludeDetails):
  â€¢ PanelTitle
  â€¢ StepTitle
  â€¢ StepPhase
  â€¢ ResponsibleUser
  â€¢ Contacts
  â€¢ CustomFields

Exemplo de RequisiÃ§Ã£o (Simples):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const panelId = 'fa8c96c0-db47-42f4-9f83-d1e257ab4a11'
const token = localStorage.getItem('auth_token')

const params = new URLSearchParams({
  panelId: panelId
})

const response = await fetch(`http://localhost:3000/api/crm/cards?${params}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Exemplo de RequisiÃ§Ã£o (Com Filtros e PaginaÃ§Ã£o):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const panelId = 'fa8c96c0-db47-42f4-9f83-d1e257ab4a11'
const token = localStorage.getItem('auth_token')

const params = new URLSearchParams({
  panelId: panelId,
  startDate: '2025-12-01T00:00:00Z',
  endDate: '2025-12-31T23:59:59Z',
  page: '1',
  pageSize: '15'
})

const response = await fetch(`http://localhost:3000/api/crm/cards?${params}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "items": [
      {
        "id": "637cb0d0-75ee-4e7c-8574-15e299637de6",
        "title": "TÃ­tulo do Card",
        "key": "ATEN-62",
        "number": 62,
        "panelId": "fa8c96c0-db47-42f4-9f83-d1e257ab4a11",
        "panelTitle": null,
        "stepId": "4645a498-48b7-4d27-84dd-74d90fed09f6",
        "stepTitle": null,
        "stepPhase": null,
        "position": 1,
        "description": "DescriÃ§Ã£o do card",
        "monetaryAmount": null,
        "isOverdue": false,
        "dueDate": null,
        "archived": false,
        "createdAt": "2025-12-03T16:27:34.767015Z",
        "updatedAt": "2025-12-03T17:03:50.343603Z",
        "responsibleUserId": "0fcbe461-b9dc-4731-be3a-0619cac93a10",
        "responsibleUser": null,
        "contactIds": ["f811001b-3944-43ae-99ac-097bd1b5286b"],
        "contacts": [],
        "companyId": "986ca29e-a041-46c2-b533-e08cd504439c",
        "tagIds": ["f7ffdfd9-a7ee-46c3-89df-be72da0523dc"],
        "sessionId": null,
        "customFields": null,
        "metadata": null
      }
    ],
    "pagination": {
      "totalItems": 7,
      "totalPages": 1,
      "pageNumber": 1,
      "pageSize": 15
    }
  },
  "message": "Cards listados com sucesso"
}

Response 400 (Erro de validaÃ§Ã£o):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": false,
  "error": "panelId Ã© obrigatÃ³rio",
  "code": "INVALID_INPUT"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           ROTA 4: DETALHES DE UM CARD
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/cards/:id

DescriÃ§Ã£o: ObtÃ©m detalhes completos de um card especÃ­fico.

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Path Parameters:
   â€¢ id (string, obrigatÃ³rio) - ID do card

Exemplo de RequisiÃ§Ã£o:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const cardId = '637cb0d0-75ee-4e7c-8574-15e299637de6'
const token = localStorage.getItem('auth_token')

const response = await fetch(`http://localhost:3000/api/crm/cards/${cardId}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "id": "637cb0d0-75ee-4e7c-8574-15e299637de6",
    "title": "TÃ­tulo do Card",
    // ... todos os campos do card
  },
  "message": "Card encontrado com sucesso"
}

Response 404 (NÃ£o encontrado):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": false,
  "error": "Card nÃ£o encontrado",
  "code": "NOT_FOUND"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                             ROTA 5: LISTAR AGENTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/agents

DescriÃ§Ã£o: Lista agentes/responsÃ¡veis de um painel especÃ­fico.

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Query Parameters:
   â€¢ panelId (string, OBRIGATÃ“RIO) - ID do painel

Exemplo de RequisiÃ§Ã£o:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const panelId = 'fa8c96c0-db47-42f4-9f83-d1e257ab4a11'
const token = localStorage.getItem('auth_token')

const params = new URLSearchParams({
  panelId: panelId
})

const response = await fetch(`http://localhost:3000/api/crm/agents?${params}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "items": [
      {
        "id": "f29f2d5e-6857-49f0-9543-83402ff2ec70",
        "createdAt": "2025-02-20T20:00:30.253097Z",
        "updatedAt": "2025-10-30T16:22:41.321897Z",
        "companyId": "986ca29e-a041-46c2-b533-e08cd504439c",
        "userId": "0fcbe461-b9dc-4731-be3a-0619cac93a10",
        "name": "Jhonatan",
        "shortName": "Jhon",
        "email": "jhonatandasilva2405@gmail.com",
        "phoneNumber": "+55|34991882622",
        "phoneNumberFormatted": "(34) 99188-2622",
        "profile": "ADMIN",
        "isOwner": true,
        "departments": [
          {
            "agentId": "00000000-0000-0000-0000-000000000000",
            "departmentId": "120505c5-eea6-4f0a-bb51-5073b9a5f2d1",
            "isAgent": true,
            "isSupervisor": true
          }
        ]
      }
    ],
    "totalItems": 1
  },
  "message": "Agentes listados com sucesso"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                          ROTA 6: DETALHES DE UM AGENTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“¡ GET /api/crm/agents/:id

DescriÃ§Ã£o: ObtÃ©m detalhes completos de um agente/atendente especÃ­fico.

âœ… AutenticaÃ§Ã£o: OBRIGATÃ“RIA
ğŸ“ Path Parameters:
   â€¢ id (string, obrigatÃ³rio) - ID do agente (userId)

Exemplo de RequisiÃ§Ã£o:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const agentId = '0fcbe461-b9dc-4731-be3a-0619cac93a10'
const token = localStorage.getItem('auth_token')

const response = await fetch(`http://localhost:3000/api/crm/agents/${agentId}`, {
  method: 'GET',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
})

const data = await response.json()

Response 200 (Sucesso):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{
  "success": true,
  "data": {
    "id": "f29f2d5e-6857-49f0-9543-83402ff2ec70",
    "userId": "0fcbe461-b9dc-4731-be3a-0619cac93a10",
    "name": "Jhonatan",
    "shortName": "Jhon",
    "email": "jhonatandasilva2405@gmail.com",
    "phoneNumber": "+55|34991882622",
    "phoneNumberFormatted": "(34) 99188-2622",
    "profile": "ADMIN",
    "isOwner": true,
    "departments": [...]
  },
  "message": "Agente encontrado com sucesso"
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        ğŸ’» CÃ“DIGO TYPESCRIPT COMPLETO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// ========================================
// 1. TIPOS (types/crm.ts)
// ========================================
export interface Panel {
  id: string
  name: string
  description: string
  createdAt: string
  updatedAt: string
  steps: Array<{
    id: string
    title: string
    phase: string
    position: number
  }>
}

export interface Card {
  id: string
  title: string
  key: string
  number: number
  panelId: string
  panelTitle: string | null
  stepId: string
  stepTitle: string | null
  stepPhase: string | null
  position: number
  description: string
  monetaryAmount: number | null
  isOverdue: boolean
  dueDate: string | null
  archived: boolean
  createdAt: string
  updatedAt: string
  responsibleUserId: string
  responsibleUser: any | null
  contactIds: string[]
  contacts: any[]
  companyId: string
  tagIds: string[]
  sessionId: string | null
  customFields: any | null
  metadata: any | null
}

export interface Agent {
  id: string
  createdAt: string
  updatedAt: string
  companyId: string
  userId: string
  name: string
  shortName: string
  email: string
  phoneNumber: string
  phoneNumberFormatted: string
  profile: string
  isOwner: boolean
  departments: Array<{
    agentId: string
    departmentId: string
    isAgent: boolean
    isSupervisor: boolean
  }>
}

export interface ApiResponse<T> {
  success: boolean
  data: T
  message: string
}

export interface PaginatedResponse<T> {
  items: T[]
  pagination: {
    totalItems: number
    totalPages: number
    pageNumber: number
    pageSize: number
  }
}

// ========================================
// 2. SERVIÃ‡O CRM (services/crmService.ts)
// ========================================
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3000'

// FunÃ§Ã£o auxiliar para headers
const getAuthHeaders = () => {
  const token = localStorage.getItem('auth_token')
  if (!token) {
    throw new Error('Token nÃ£o encontrado. FaÃ§a login novamente.')
  }
  
  return {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  }
}

// FunÃ§Ã£o auxiliar para tratamento de erros
const handleResponse = async <T>(response: Response): Promise<ApiResponse<T>> => {
  const data = await response.json()
  
  if (!response.ok) {
    if (response.status === 401) {
      // Token expirado, fazer logout
      localStorage.removeItem('auth_token')
      window.location.href = '/login'
      throw new Error('SessÃ£o expirada. FaÃ§a login novamente.')
    }
    throw new Error(data.error || 'Erro na requisiÃ§Ã£o')
  }
  
  return data
}

// 1. Listar PainÃ©is
export const getPanels = async (): Promise<ApiResponse<{ items: Panel[], totalItems: number }>> => {
  const response = await fetch(`${API_BASE_URL}/api/crm/panels`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<{ items: Panel[], totalItems: number }>(response)
}

// 2. Detalhes de um Painel
export const getPanelById = async (id: string): Promise<ApiResponse<Panel>> => {
  const response = await fetch(`${API_BASE_URL}/api/crm/panels/${id}`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<Panel>(response)
}

// 3. Listar Cards
export interface GetCardsParams {
  panelId: string
  startDate?: string
  endDate?: string
  userId?: string
  channelId?: string
  stepId?: string
  page?: number
  pageSize?: number
}

export const getCards = async (params: GetCardsParams): Promise<ApiResponse<PaginatedResponse<Card>>> => {
  const queryParams = new URLSearchParams()
  
  Object.entries(params).forEach(([key, value]) => {
    if (value !== undefined && value !== null) {
      queryParams.append(key, String(value))
    }
  })
  
  const response = await fetch(`${API_BASE_URL}/api/crm/cards?${queryParams}`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<PaginatedResponse<Card>>(response)
}

// 4. Detalhes de um Card
export const getCardById = async (id: string): Promise<ApiResponse<Card>> => {
  const response = await fetch(`${API_BASE_URL}/api/crm/cards/${id}`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<Card>(response)
}

// 5. Listar Agentes
export const getAgents = async (panelId: string): Promise<ApiResponse<{ items: Agent[], totalItems: number }>> => {
  const params = new URLSearchParams({ panelId })
  
  const response = await fetch(`${API_BASE_URL}/api/crm/agents?${params}`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<{ items: Agent[], totalItems: number }>(response)
}

// 6. Detalhes de um Agente
export const getAgentById = async (id: string): Promise<ApiResponse<Agent>> => {
  const response = await fetch(`${API_BASE_URL}/api/crm/agents/${id}`, {
    method: 'GET',
    headers: getAuthHeaders()
  })
  
  return handleResponse<Agent>(response)
}

// ========================================
// 3. EXEMPLO DE USO EM COMPONENTE REACT
// ========================================
import { useState, useEffect } from 'react'
import { getPanels, getCards, getAgents } from '@/services/crmService'

const CrmDashboard = () => {
  const [panels, setPanels] = useState([])
  const [selectedPanel, setSelectedPanel] = useState(null)
  const [cards, setCards] = useState([])
  const [agents, setAgents] = useState([])
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState(null)

  // Carregar painÃ©is ao montar componente
  useEffect(() => {
    loadPanels()
  }, [])

  const loadPanels = async () => {
    try {
      setLoading(true)
      const response = await getPanels()
      setPanels(response.data.items)
    } catch (err) {
      setError(err.message)
    } finally {
      setLoading(false)
    }
  }

  // Carregar cards quando selecionar um painel
  const handleSelectPanel = async (panelId: string) => {
    try {
      setLoading(true)
      const [cardsResponse, agentsResponse] = await Promise.all([
        getCards({ panelId, page: 1, pageSize: 50 }),
        getAgents(panelId)
      ])
      
      setCards(cardsResponse.data.items)
      setAgents(agentsResponse.data.items)
      setSelectedPanel(panelId)
    } catch (err) {
      setError(err.message)
    } finally {
      setLoading(false)
    }
  }

  if (loading) return <div>Carregando...</div>
  if (error) return <div>Erro: {error}</div>

  return (
    <div>
      <h1>PainÃ©is CRM</h1>
      {panels.map(panel => (
        <div key={panel.id} onClick={() => handleSelectPanel(panel.id)}>
          <h2>{panel.name}</h2>
          <p>{panel.description}</p>
        </div>
      ))}
      
      {selectedPanel && (
        <div>
          <h2>Cards</h2>
          {cards.map(card => (
            <div key={card.id}>
              <h3>{card.title}</h3>
              <p>{card.description}</p>
            </div>
          ))}
          
          <h2>Agentes</h2>
          {agents.map(agent => (
            <div key={agent.id}>
              <h3>{agent.name}</h3>
              <p>{agent.email}</p>
            </div>
          ))}
        </div>
      )}
    </div>
  )
}


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                              âš ï¸ TRATAMENTO DE ERROS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CÃ³digos de Erro Comuns:

401 - Unauthorized:
  â€¢ Token nÃ£o informado
  â€¢ Token invÃ¡lido ou expirado
  â†’ AÃ§Ã£o: Fazer logout e redirecionar para login

403 - Forbidden:
  â€¢ UsuÃ¡rio sem permissÃ£o
  â†’ AÃ§Ã£o: Mostrar mensagem de acesso negado

404 - Not Found:
  â€¢ Recurso nÃ£o encontrado (painel, card, agente)
  â†’ AÃ§Ã£o: Mostrar mensagem amigÃ¡vel

400 - Bad Request:
  â€¢ Dados invÃ¡lidos (ex: panelId obrigatÃ³rio nÃ£o informado)
  â†’ AÃ§Ã£o: Mostrar mensagem de validaÃ§Ã£o

429 - Too Many Requests:
  â€¢ Rate limit excedido (60 req/min)
  â†’ AÃ§Ã£o: Aguardar antes de tentar novamente

500 - Internal Server Error:
  â€¢ Erro no servidor
  â†’ AÃ§Ã£o: Tentar novamente ou reportar erro


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                           ğŸ“ RESUMO RÃPIDO - CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ ] Fazer login e salvar o token no localStorage
[ ] Criar funÃ§Ã£o getAuthHeaders() para adicionar token automaticamente
[ ] Criar funÃ§Ã£o handleResponse() para tratar erros (especialmente 401)
[ ] Implementar chamadas para cada rota CRM
[ ] Tratar paginaÃ§Ã£o nos cards (page, pageSize)
[ ] Tratar filtros opcionais nos cards (datas, usuÃ¡rios, etc)
[ ] Implementar loading states
[ ] Implementar error handling
[ ] Fazer logout e redirecionar quando token expirar (401)
[ ] Adicionar interceptors/interceptors para adicionar token automaticamente


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                                    FIM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

